ZMK-прошивка не поддерживает подключение «по Wi-Fi». Для беспроводной работы применяется Bluetooth Low Energy (BLE) либо проводной режим USB. ([ZMK Firmware][1])

Ниже приведён порядок действий, позволяющий восстановить работоспособность и добиться подключения по BLE.

## 1. Проверка соответствия прошивки установленному контроллеру

В архиве сформированы два варианта UF2 для разных плат:

* `revxlp-seeeduino_xiao-zmk.uf2` — для Seeeduino XIAO (SAMD21). BLE отсутствует, возможна только работа по USB.
* `revxlp-xiao_ble-zmk.uf2` — для XIAO BLE / nRF52840. BLE поддерживается.

Если установлен контроллер **SAMD21**, попытки «беспроводного подключения» результата не дадут по причине отсутствия BLE на уровне аппаратуры.

## 2. Типовой сценарий «клавиатура не реагирует»: вывод настроен не туда

ZMK запоминает выбранный активный интерфейс вывода (USB или BLE). Если вывод оказался переключён на BLE-профиль без сопряжения (или на USB при ожидании BLE), нажатия могут восприниматься как «неработающие». ([ZMK Firmware][2])

В текущей раскладке уже предусмотрено переключение вывода:

* в слое NAVI (указан как `raise_layer`) есть `&out OUT_TOG` — переключение USB ↔ BLE.

Комбинация по разметке файла:

* удержать клавишу `RET` с hold-tap `&lt NAVI RET` (войти в слой NAVI),
* нажать клавишу, которая в базовом слое является `LSHFT` (в слое NAVI на её месте находится `&out OUT_TOG`).

После переключения на BLE следует выполнить выбор профиля и сопряжение (раздел 3).

## 3. Сопряжение по BLE и выбор профиля

ZMK использует несколько BLE-профилей (обычно 5). Если выбран профиль, который ранее уже был сопряжён с другим устройством, подключение может не происходить до очистки привязок. ([ZMK Firmware][3])

В слое ADJUST в раскладке предусмотрено:

* `&bt BT_CLR` — очистка привязок (bond) текущего/выбранного профиля;
* `&bt BT_SEL 0..4` — выбор профиля (BT1..BT5).

Рекомендуемая процедура:

1. На компьютере/телефоне удалить («забыть») старое устройство клавиатуры в настройках Bluetooth (если оно уже было).
2. На клавиатуре перейти в ADJUST и выполнить `BT_CLR`.
3. Выбрать профиль `BT_SEL 0` (канал 1) и запустить сопряжение на стороне хоста. ([ZMK Firmware][3])

Контроль: наличие устройства в списке BLE-устройств на телефоне является быстрым признаком того, что прошивка запущена и рекламируется.

## 4. Если клавиатура не реагирует вообще: очистка сохранённых настроек через settings reset

Если нажатия не удаётся использовать для переключения вывода/профилей (например, устройство «как будто мёртвое»), следует сбросить сохранённые настройки ZMK (включая выбранный вывод и BLE-привязки) через специальную прошивку `settings_reset`. ([ZMK Firmware][4])

### 4.1 Как собрать `settings_reset` через GitHub Actions

В `build.yaml` добавить отдельную сборку:

```yaml
include:
  - board: seeeduino_xiao
    shield: revxlp
  - board: xiao_ble
    shield: revxlp
  - board: xiao_ble
    shield: settings_reset
```

(Если требуется сброс для USB-варианта, добавляется аналогичная строка с `board: seeeduino_xiao` и `shield: settings_reset`.)

### 4.2 Как применять settings reset

1. Перевести контроллер(ы) в загрузчик.
2. Прошить файл `settings_reset` (на split-клавиатуре — на каждую половину отдельно).
3. Затем прошить обычную рабочую прошивку заново. ([ZMK Firmware][5])

## 5. Проверка, что устройство не осталось в загрузчике

Если после прошивки устройство постоянно отображается как USB-накопитель (режим UF2) и не переходит в режим клавиатуры, значит прошивка не стартует (либо постоянно удерживается reset/boot-режим). В этом случае:

* повторно прошить корректный UF2, соответствующий плате (раздел 1);
* убедиться в исправном USB-кабеле (с передачей данных) и корректном питании.

Если после выполнения пунктов 1–5 устройство всё ещё не рекламируется по BLE и не определяется как USB-клавиатура, для точной локализации потребуется указать: какой физический контроллер установлен (SAMD21 или nRF52840), используется ли split-конфигурация, и появляется ли устройство в списке Bluetooth-устройств на телефоне.

[1]: https://zmk.dev/docs/features/bluetooth?utm_source=chatgpt.com "Bluetooth"
[2]: https://zmk.dev/docs/keymaps/behaviors/outputs?utm_source=chatgpt.com "Output Selection Behavior"
[3]: https://zmk.dev/docs/keymaps/behaviors/bluetooth?utm_source=chatgpt.com "Bluetooth Behavior"
[4]: https://zmk.dev/docs/config/settings?utm_source=chatgpt.com "Persistent Settings - ZMK Firmware"
[5]: https://zmk.dev/docs/troubleshooting/connection-issues?utm_source=chatgpt.com "ZMK Firmware - Connection Issues"

