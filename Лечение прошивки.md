Отсутствие реакции на нажатия, отсутствие ввода по USB и отсутствие видимости по Bluetooth после прошивки (при успешной сборке) типично указывает на то, что собранный образ ZMK получился «минимальным» и в нём не включены критичные подсистемы (USB HID, Bluetooth стек, хранилище настроек). Для `xiao_ble` это дополнительно подтверждается актуальным регрессионным сценарием после перехода ZMK на Zephyr 4.1: ряд функций перестал включаться автоматически и требует явного задания `CONFIG_…` параметров. ([GitHub][1])

Дополнительно следует учитывать, что ZMK не поддерживает подключение по Wi-Fi: штатные интерфейсы — USB и Bluetooth Low Energy (BLE). ([zmk.dev][2])

Ниже приведён вариант исправления, который не требует изменения исходников ZMK и подходит для конфигурационного репозитория.

## 1. Включение обязательных функций для платы `xiao_ble` через board extension

Рекомендуется добавить расширение платы (board extension), чтобы параметры применялись ко всем сборкам на этой плате, включая `settings_reset`.

1. Создать каталог:

`config/boards/extensions/xiao_ble/`

2. Создать файл:

`config/boards/extensions/xiao_ble/board.conf`

3. Записать в `board.conf` следующий набор параметров (минимально достаточный для оживления USB и BLE, а также сохранения/сброса настроек):

```conf
# Базовые функции ZMK для xiao_ble (nRF52840)
CONFIG_ZMK_USB=y
CONFIG_ZMK_BLE=y

# BLE стек Zephyr (роль peripheral необходима для клавиатуры)
CONFIG_BT=y
CONFIG_BT_PERIPHERAL=y

# Постоянные настройки (bonding, выбранный output и т.п.)
CONFIG_SETTINGS=y
CONFIG_ZMK_SETTINGS=y
```

Почему именно так:

* В регрессионном сценарии после Zephyr 4.1 явное включение `CONFIG_ZMK_USB`, `CONFIG_ZMK_BLE` и параметров Bluetooth требуется для того, чтобы прошивка не собиралась «облегчённой» и действительно поднимала USB/BLE. ([GitHub][1])
* Сброс/хранение привязок Bluetooth в ZMK опирается на подсистему persistent settings (хранилище настроек). ([zmk.dev][3])

## 2. Диагностика (рекомендуется при повторении симптомов)

Если после пункта 1 устройство по-прежнему не определяется/не подаёт признаков жизни, целесообразно временно включить USB-логирование, чтобы увидеть, стартует ли прошивка и что происходит при инициализации USB/BLE.

Добавить в тот же `board.conf` (временно):

```conf
CONFIG_ZMK_USB_LOGGING=y
CONFIG_LOG=y
CONFIG_LOG_DEFAULT_LEVEL=3
```

Подключение к логам выполняется через USB CDC ACM (в Linux обычно `/dev/ttyACM0`), порядок описан в документации ZMK. ([zmk.dev][4])

После стабилизации работы logging следует отключить, чтобы не ухудшать энергопотребление. ([zmk.dev][4])

## 3. Контрольная проверка после пересборки

1. Пересобрать и прошить **именно** образ для `xiao_ble` (например, `revxlp-xiao_ble-zmk.uf2`), а не вариант для `seeeduino_xiao` (SAMD21).
2. Проверить по ПК, что устройство появляется как USB HID-клавиатура (в Linux — `lsusb`, `dmesg`; в Windows — диспетчер устройств).
3. Для BLE: выполнить поиск нового BLE-устройства с именем, заданным в `Kconfig.defconfig` (в архиве: `revxlp`) и выполнить первичное сопряжение.
4. Если BLE не виден при подключенном USB — проверить выбор активного выхода (output). В ZMK выбор интерфейса/профилей управляется поведениями Bluetooth и сохраняется в persistent settings. ([zmk.dev][2])

## 4. Внесение изменений в репозиторий (чтобы GitHub Actions собрал новую прошивку)

После добавления файлов требуется зафиксировать изменения:

```bash
git status
git add config/boards/extensions/xiao_ble/board.conf
# (и другие изменённые файлы, если добавлялись)
git commit -m "Enable USB/BLE and settings for xiao_ble via board extension"
git push
```

После выполнения `git push` workflow GitHub Actions должен собрать прошивку с включёнными USB/BLE/настройками; при успешном применении исправления устройство начнёт определяться по USB и станет доступно для BLE-сопряжения. ([GitHub][1])

[1]: https://github.com/zmkfirmware/zmk/issues/3234 "Regression: Multiple features no longer auto-enabled · Issue #3234 · zmkfirmware/zmk · GitHub"
[2]: https://zmk.dev/docs/keymaps/behaviors/bluetooth?utm_source=chatgpt.com "Bluetooth Behavior"
[3]: https://zmk.dev/docs/config/settings?utm_source=chatgpt.com "Persistent Settings"
[4]: https://zmk.dev/docs/development/usb-logging?utm_source=chatgpt.com "USB Logging"

